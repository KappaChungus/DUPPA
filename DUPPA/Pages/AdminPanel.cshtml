@page
@using DUPPA.Database
@model DUPPA.Pages.AdminPanel

<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <style>
        .image-option {
            border: 3px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: border 0.2s;
        }

        .image-option.selected {
            border-color: #007bff;
        }

        .image-grid {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <form method="post">
        <!-- Date picker -->
        <div class="mb-3">
            <label for="selectedDate" class="form-label">Data:</label>
            <input type="date"
                   id="selectedDate"
                   name="SelectedDate"
                   class="form-control"
                   value="@Model.SelectedDate.ToString("yyyy-MM-dd")"
                   onchange="this.form.submit()" /> <!-- Formularz wysyła datę przy zmianie -->
        </div>

        <!-- Dyżurny -->
        <div class="mb-3">
            <label for="selectedOption" class="form-label">Dyżurny:</label>
            <select class="form-select" id="selectedOption" name="SelectedOption">
                @foreach (var option in DataBase.Instance.GetUsers())
                {
                    <option value="@option.Name" selected="@(Model.SelectedOption == option.Name ? "selected" : null)">
                        @option.Name
                    </option>
                }
            </select>
        </div>

        <!-- optional textfield -->
        <div class="mb-3">
            <label for="optionalNote" class="form-label">Notatka (opcjonalnie):</label>
            <input type="text"
                   class="form-control"
                   id="optionalNote"
                   name="OptionalNote"
                   placeholder="Wpisz dodatkową informację (jeśli chcesz)"
                   value="@Model.OptionalNote" />
        </div>

        <!-- Image selection -->
        <div class="mb-3">
            <input type="hidden" id="selectedImageId" name="SelectedImageId" value="@Model.SelectedImageId"/>

            <div class="image-grid">
                @for (int i = 1; i <= 5; i++)
                {
                    <img src="@($"/images/score{i}.png")"
                         width="40" height="40"
                         class="image-option @(Model.SelectedImageId == i ? "selected" : "")"
                         data-image-id="@i"
                         onclick="selectImage(@i)"/>
                }
            </div>
        </div>

        <!-- Submit -->
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>

<script>
    function selectImage(imageId) {
        document.getElementById("selectedImageId").value = imageId;

        const allImages = document.querySelectorAll(".image-option");
        allImages.forEach(img => img.classList.remove("selected"));

        const selectedImg = document.querySelector(`.image-option[data-image-id='${imageId}']`);
        selectedImg.classList.add("selected");
    }
</script>
</body>
</html>
